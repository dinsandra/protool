(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{40:function(e,t,a){"use strict";a.r(t),a.d(t,"converterFormats",function(){return u}),a.d(t,"converterName",function(){return p}),a.d(t,"converterExtension",function(){return d}),a.d(t,"convertTo",function(){return h}),a.d(t,"convertFrom",function(){return O}),a.d(t,"defaultValueForField",function(){return C}),a.d(t,"messageToProto",function(){return b});var n=a(8),r=a(14),s=r.List,o=r.Map,l=a(16),i=a(39),c={binary:["Binary","pbdata",m,y],"binary-hex":["Binary (hex)","pbdata.hex",function(e,t){var a=m(e,t);return Array.from(a).map(function(e){return(e<16?"0":"")+e.toString(16)}).join("").toUpperCase()},function(e,t){for(var a=[],n=0;n<t.length;n+=2)a.push(parseInt(t.substring(n,n+2),16));return y(e,new Uint8Array(a))}],"binary-b64":["Binary (base64)","pbdata.b64",function(e,t){var a=m(e,t);return l.util.base64.encode(a,0,a.length)},function(e,t){var a=window.atob(t);return y(e,a)}],json:["Json","json",function(e,t){var a=b(e,t);return JSON.stringify(a)},function(e,t){var a=JSON.parse(k(t));return E(e,a)}],"json-camel":["Json (camelCase)","cc.json",function(e,t){var a=b(e,t),n=f(e,e.toObject(a,l.util.toJSONOptions),function(e){return l.util.camelCase(e)});return JSON.stringify(n)},function(e,t){var a=JSON.parse(k(t)),n=j(e,a,function(e){return l.util.camelCase(e)});return E(e,n)}],"json-id":["Json (field-IDs)","ids.json",function(e,t){var a=b(e,t),n=f(e,e.toObject(a,l.util.toJSONOptions),function(e,t){return t.fields[e].id});return JSON.stringify(n)},function(e,t){var a=JSON.parse(k(t)),n=j(e,a,function(e,t){return t.fields[e].id});return E(e,n)}]},u=Object.keys(c).sort();function p(e){return c[e][0]}function d(e){return c[e][1]}function h(e,t,a){return c[e][2](t,a)}function m(e,t){var a=b(e,t);return e.encode(a).finish()}function f(e,t,a){return Object.fromEntries(Object.entries(t).map(function(t){var r=Object(n.a)(t,2),s=r[0],o=r[1],i=a(s,e),c=e.fields[s]||e.fields[i];return c.resolvedType&&c.resolvedType.constructor===l.Type?c.repeated?[i,o.map(function(e){return f(c.resolvedType,e,a)})]:[i,f(c.resolvedType,o,a)]:[i,o]}))}function b(e,t){var a=v(e,t);return e.fromObject(a)}function v(e,t){return t.mapEntries(function(t){var a=Object(n.a)(t,2),r=a[0],s=a[1],o=e.fieldsById[r];return[o.name,function(e,t){return e.repeated?t.map(function(t){return g(e,t.get("value"))}).toArray():1===t.size?g(e,t.get(0).get("value")):null}(o,s)]}).toObject()}function g(e,t){switch(e.type){case"string":case"bytes":case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":case"float":case"double":case"bool":return t}var a=e.resolvedType;return null===a?(console.error("Unhandled value type",e),""):a.constructor===l.Enum?t:a.constructor===l.Type?v(a,t):(console.error("Unhandled value type",e),"")}function O(e,t,a){return c[e][3](t,a)}function y(e,t){var a=e.decode(t);return E(e,a,{binary:!0})}function k(e){return e instanceof Uint8Array?new TextDecoder("utf-8").decode(e):e}function j(e,t,a){return f(e,t,function(e,t){return function(e,t,a){for(var n in t.fields)if(a(n,t).toString()===e)return n;for(var r in console.error("Failed to match key"),t.fields)console.error("tried",a(r,t),"===",e);console.error("all false.")}(e,t,a)})}function E(e,t,a){return o(Object.entries(t).map(function(t){var r=Object(n.a)(t,2),c=r[0],u=r[1],p=e.fields[c];return[p.id,function(e,t,a){var n=e.repeated?t:[t];return s(n.map(function(t){return o({id:i.generate(),value:function(e,t,a){switch(e.type){case"bytes":var n=a&&a.binary;return n?l.util.base64.encode(t,0,t.length):t;case"string":case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":case"float":case"double":case"bool":return t}var r=e.resolvedType;if(null===r)return console.error("Unhandled value type",e),"";if(r.constructor===l.Enum)return t;if(r.constructor===l.Type)return E(r,t,a);return console.error("Unhandled value type",e),""}(e,t,a)})}))}(p,u,a)]}))}function C(e){switch(e.type){case"string":case"bytes":return"";case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":case"float":case"double":return"0";case"bool":return!1}var t=e.resolvedType;return null===t?(console.error("Unhandled default type, expected resolved type",e),""):t.constructor===l.Enum?parseInt(s(Object.keys(t.valuesById)).sort().first(),10):t.constructor===l.Type?o():(console.error("Unhandled default type",e),"")}},42:function(e,t,a){e.exports=a(75)},73:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(41),o=a.n(s),l=a(2),i=a(3),c=a(5),u=a(4),p=a(6),d=a(1),h=a(8),m=a(14).fromJS,f={load:function(){var e=m(JSON.parse(window.localStorage.getItem("stored_protos")||"{}"));return console.log("rawStoredProtos",e),e},save:function(e){e.isEmpty()?(console.log("REMOVING:",e.toJSON()),window.localStorage.removeItem("stored_protos")):(console.log("SAVING:",e.toJSON()),window.localStorage.setItem("stored_protos",JSON.stringify(e.toJSON())))}},b={load:function(){return window.localStorage.getItem("format")||"binary"},save:function(e){"binary"===e?window.localStorage.removeItem("format"):window.localStorage.setItem("format",e)}},v=a(16),g=a(39),O=a(40),y=a(14),k=y.List,j=y.Map,E=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return void 0===this.props.messageToBuild?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,this.props.messageToBuild.name," builder"),r.a.createElement(F,{path:k(),messageToBuild:this.props.messageToBuild,values:this.props.message,callbacks:this.props.callbacks}),r.a.createElement(C,{messageToBuild:this.props.messageToBuild,outputFormat:this.props.outputFormat,builtMessage:this.props.builtMessage,buildMessageUpToDate:this.props.buildMessageUpToDate,callbacks:this.props.callbacks}))}}]),t}(r.a.Component),C=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleExportToFile=function(){return a.props.callbacks.onBuild("save")},a.handleChangeOutputFormat=a.handleChangeOutputFormat.bind(Object(d.a)(Object(d.a)(a))),a.handleFileChange=a.handleFileChange.bind(Object(d.a)(Object(d.a)(a))),a.handleImportFromFile=a.handleImportFromFile.bind(Object(d.a)(Object(d.a)(a))),a.handleChangeBuiltMessage=a.handleChangeBuiltMessage.bind(Object(d.a)(Object(d.a)(a))),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChangeOutputFormat",value:function(e){this.props.callbacks.onSetOutputFormat(e.target.value)}},{key:"handleFileChange",value:function(e){var t=e.target.files[0],a=this,n=new FileReader;n.onload=function(){var e=new Uint8Array(n.result);a.props.callbacks.onImport(e)},n.onerror=function(e){console.error("FileLoading of",t,"failed:",e)},n.readAsArrayBuffer(t)}},{key:"handleImportFromFile",value:function(){this.refs.fileuploader.click()}},{key:"handleChangeBuiltMessage",value:function(e){var t="binary"===this.props.outputFormat?new Uint8Array(e.target.value.split(",")):e.target.value;this.props.callbacks.onImport(t)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,"Format:",r.a.createElement("select",{onChange:this.handleChangeOutputFormat,defaultValue:this.props.outputFormat},O.converterFormats.map(function(e){return r.a.createElement("option",{key:e,value:e},O.converterName(e))})),r.a.createElement("br",null),"import",r.a.createElement("button",{onClick:this.handleImportFromFile},"Load from file"),r.a.createElement("input",{type:"file",ref:"fileuploader",onChange:this.handleFileChange,hidden:!0}),r.a.createElement("br",null),"export",r.a.createElement("button",{onClick:this.handleExportToFile}," Save as file "),r.a.createElement("br",null),r.a.createElement("textarea",{value:null!==this.props.builtMessage[0]?this.props.builtMessage[0]:this.props.builtMessage[1],cols:"200",rows:"3",className:null===this.props.builtMessage[0]?"invalid":"",disabled:!this.props.buildMessageUpToDate,onChange:this.handleChangeBuiltMessage}))}}]),t}(r.a.Component),F=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).isRegularField=function(e){return null===e.partOf},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=Object.values(this.props.messageToBuild.fields).filter(this.isRegularField),a=Object.values(this.props.messageToBuild.oneofs||{}),n=t.map(function(t){return r.a.createElement("li",{key:t.name},r.a.createElement("b",null,t.type,t.repeated?"*":"",t.required?"!":"")," - ",t.name," = ",t.id,r.a.createElement(S,{path:e.props.path.concat([t.id]),field:t,valueEntries:e.props.values.get(t.id)||k(),callbacks:e.props.callbacks}))}),s=a.map(function(t){return r.a.createElement("li",{key:t.name},r.a.createElement("b",null,"oneof")," ",t.name,r.a.createElement(T,{path:e.props.path,messageToBuild:e.props.messageToBuild,oneOfDescriptor:t,values:e.props.values,callbacks:e.props.callbacks}))});return r.a.createElement("ul",null,n,s)}}]),t}(r.a.Component),S=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleSet",value:function(){this.props.callbacks.onAdd(this.props.path,j({id:g.generate(),value:O.defaultValueForField(this.props.field)}))}},{key:"handleDelete",value:function(e){this.props.callbacks.onDelete(this.props.path.concat([e]))}},{key:"handleDuplicate",value:function(e){this.props.callbacks.onAdd(this.props.path,e.set("id",g.generate()))}},{key:"handleMoveUp",value:function(e){this.props.callbacks.onMove(this.props.path,e,e-1)}},{key:"handleMoveDown",value:function(e){this.props.callbacks.onMove(this.props.path,e,e+1)}},{key:"render",value:function(){var e=this,t=0===this.props.valueEntries.size,a=this.props.field.repeated,n=null===this.props.field.partOf,s=this.props.field.repeated,o=this.props.field.repeated;return r.a.createElement("ul",null,this.props.valueEntries.map(function(t,a){var l=a!==e.props.valueEntries.size-1,i=0!==a;return r.a.createElement("li",{key:t.get("id")},r.a.createElement("button",{onClick:function(){return e.handleDelete(a)},hidden:!n,className:"tiny"},"-"),r.a.createElement("button",{onClick:function(){return e.handleDuplicate(t)},hidden:!s,className:"tiny"},"*"),r.a.createElement("button",{onClick:function(){return e.handleMoveDown(a)},hidden:!o,disabled:!l,className:"tiny"},"v"),r.a.createElement("button",{onClick:function(){return e.handleMoveUp(a)},hidden:!o,disabled:!i,className:"tiny"},"^"),r.a.createElement(B,{path:e.props.path.concat([a,"value"]),field:e.props.field,value:t.get("value"),callbacks:e.props.callbacks}))}),(a||t)&&r.a.createElement("li",null,r.a.createElement("button",{onClick:function(){return e.handleSet()}}," ",a?"add":"set"," ")))}}]),t}(r.a.Component),T=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).currentFieldDescriptor=function(){var e=a.props.values.keySeq().find(function(e){return a.props.messageToBuild.fieldsById[e].partOf===a.props.oneOfDescriptor});return void 0===e?null:a.props.messageToBuild.fieldsById[e]},a.onChange=function(e){var t=a.currentFieldDescriptor();if(null!==t&&a.props.callbacks.onDelete(a.props.path.concat([t.id,0])),0!==e.target.value.length){var n=parseInt(e.target.value,10),r=a.props.messageToBuild.fieldsById[n];a.props.callbacks.onAdd(a.props.path.concat([r.id]),j({id:g.generate(),value:O.defaultValueForField(r)}))}},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.currentFieldDescriptor();return console.log("MessageOneOfFieldValuesBuilder",e),r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("select",{value:null!==e?e.id:"",onChange:this.onChange},r.a.createElement("option",{value:""}),this.props.oneOfDescriptor.fieldsArray.map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.type," - ",e.name," = ",e.id)})),null!==e?r.a.createElement(S,{path:this.props.path.concat([e.id]),field:e,valueEntries:this.props.values.get(e.id)||k(),callbacks:this.props.callbacks}):r.a.createElement(r.a.Fragment,null))))}}]),t}(r.a.Component),B=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){switch(this.props.field.type){case"string":return r.a.createElement(M,{path:this.props.path,field:this.props.field,value:this.props.value,callbacks:this.props.callbacks});case"bytes":return r.a.createElement(w,{path:this.props.path,field:this.props.field,value:this.props.value,callbacks:this.props.callbacks});case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":return r.a.createElement(D,{path:this.props.path,field:this.props.field,value:this.props.value,callbacks:this.props.callbacks});case"float":case"double":return r.a.createElement(I,{path:this.props.path,field:this.props.field,value:this.props.value,callbacks:this.props.callbacks});case"bool":return r.a.createElement(N,{path:this.props.path,field:this.props.field,value:this.props.value,callbacks:this.props.callbacks})}var e=this.props.field.resolvedType;return e.constructor===v.Enum?r.a.createElement(A,{path:this.props.path,field:this.props.field,type:e,value:this.props.value,callbacks:this.props.callbacks}):e.constructor===v.Type?r.a.createElement(F,{path:this.props.path,messageToBuild:e,values:this.props.value,callbacks:this.props.callbacks}):(console.error("Unhandled input type",this.props.field.type),r.a.createElement("div",null))}}]),t}(r.a.Component),M=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.props.callbacks.onSet(this.props.path,e.target.value)}},{key:"render",value:function(){var e=this;return r.a.createElement("textarea",{onChange:function(t){return e.handleChange(t)},value:this.props.value})}}]),t}(r.a.Component),w=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){return a.handleChange(e)},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){return v.util.base64.test(this.props.value)}},{key:"handleChange",value:function(e){this.props.callbacks.onSet(this.props.path,e.target.value)}},{key:"render",value:function(){var e=this.isValid();return r.a.createElement("textarea",{onChange:this.onChange,value:this.props.value,className:e?"":"invalid"})}}]),t}(r.a.Component),D=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onChange=a.handleChange.bind(Object(d.a)(Object(d.a)(a))),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){return/^[0-9]+$/.test(this.props.value)}},{key:"handleChange",value:function(e){this.props.callbacks.onSet(this.props.path,e.target.value)}},{key:"render",value:function(){var e=this.isValid();return r.a.createElement("input",{type:"text",onChange:this.onChange,value:this.props.value,className:e?"":"invalid"})}}]),t}(r.a.Component),I=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).onChange=a.handleChange.bind(Object(d.a)(Object(d.a)(a))),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"isValid",value:function(){return/^[0-9]+$|^[0-9]+[.][0-9]*$|^[0-9]*[.][0-9]+$/.test(this.props.value)}},{key:"handleChange",value:function(e){this.props.callbacks.onSet(this.props.path,e.target.value)}},{key:"render",value:function(){var e=this.isValid();return r.a.createElement("input",{type:"text",onChange:this.onChange,value:this.props.value,className:e?"":"invalid"})}}]),t}(r.a.Component),N=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.props.callbacks.onSet(this.props.path,e.target.checked)}},{key:"render",value:function(){var e=this;return r.a.createElement("input",{type:"checkbox",checked:this.props.value,onChange:function(t){return e.handleChange(t)}})}}]),t}(r.a.Component),A=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){var t=parseInt(e.target.value);this.props.callbacks.onSet(this.props.path,t)}},{key:"render",value:function(){var e=this,t=k(Object.keys(this.props.type.valuesById)).sort();return r.a.createElement("select",{defaultValue:this.props.value,onChange:function(t){return e.handleChange(t)}},t.map(function(t){return r.a.createElement("option",{value:t,key:t},e.props.type.valuesById[t]," = ",t)}))}}]),t}(r.a.Component),x=E,R=a(16),P=a(14).List,J=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Known namespaces and messages"),r.a.createElement(U,{protoRoot:this.props.protoRoot,callbacks:this.props.callbacks}),r.a.createElement("h2",null,"Known files"),r.a.createElement(q,{filenames:this.props.filenames,fileDependencies:this.props.fileDependencies,callbacks:this.props.callbacks}),r.a.createElement(z,{callbacks:this.props.callbacks}),r.a.createElement(_,{callbacks:this.props.callbacks}))}}]),t}(r.a.Component),U=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.protoRoot?r.a.createElement(V,{name:"",namespace:this.props.protoRoot,callbacks:this.props.callbacks}):r.a.createElement(r.a.Fragment,null)}}]),t}(r.a.Component),V=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,a=this.props.namespace.nested||{},n=Object.entries(a),s=n.filter(function(e){var t=Object(h.a)(e,2);t[0];return t[1].constructor===R.Namespace}),o=n.filter(function(e){var t=Object(h.a)(e,2);t[0];return t[1].constructor===R.Type});if(this.props.namespace.constructor===R.Namespace){var l=this.props.name?this.props.name+".":"";if(1===s.length&&0===o.length){var i=Object(h.a)(s[0],2),c=i[0],u=i[1];return r.a.createElement(t,{name:l+c,namespace:u,callbacks:this.props.callbacks})}if(0===s.length&&1===o.length){var p=Object(h.a)(o[0],2),d=p[0],m=p[1];return r.a.createElement(L,{name:l+d,message:m,callbacks:this.props.callbacks})}}return r.a.createElement(r.a.Fragment,null,this.props.name,r.a.createElement("button",{onClick:function(){return e.props.callbacks.onSelectMessageToBuild(e.props.namespace)},hidden:!this.props.buildable},"build"),r.a.createElement("ul",null,s.map(function(a){var n=Object(h.a)(a,2),s=n[0],o=n[1];return r.a.createElement("li",{key:s},r.a.createElement(t,{name:s,namespace:o,callbacks:e.props.callbacks}))}),o.map(function(t){var a=Object(h.a)(t,2),n=a[0],s=a[1];return r.a.createElement("li",{key:n},r.a.createElement(L,{name:n,message:s,callbacks:e.props.callbacks}))})))}}]),t}(r.a.Component),L=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(V,{name:this.props.name,namespace:this.props.message,buildable:!0,callbacks:this.props.callbacks})}}]),t}(r.a.Component),q=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("ul",null,this.props.filenames.sort().map(function(t){return r.a.createElement("li",{key:t},r.a.createElement($,{filename:t,fileDependencies:e.props.fileDependencies,callbacks:e.props.callbacks}))}))}}]),t}(r.a.Component),$=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){a.props.callbacks.onRemoveProto(a.props.filename)},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.fileDependencies.get(this.props.filename,P()),t=e.isEmpty()?r.a.createElement(r.a.Fragment,null):r.a.createElement(q,{filenames:e,fileDependencies:this.props.fileDependencies,callbacks:this.props.callbacks});return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.handleClick,disabled:!e.isEmpty(),className:"tiny"},"-"),this.props.filename,t)}}]),t}(r.a.Component),z=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isAdding:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleStartAdding",value:function(){this.setState({isAdding:!0})}},{key:"handleSubmit",value:function(){var e=this.refs.fileName.value,t=this.refs.protoText.value;this.setState({isAdding:!1}),this.props.callbacks.onAddProto(e,t)}},{key:"render",value:function(){var e=this;return this.state.isAdding?r.a.createElement(r.a.Fragment,null,"File name: ",r.a.createElement("input",{type:"text",ref:"fileName"})," ",r.a.createElement("br",null),"ProtoContent: ",r.a.createElement("br",null),r.a.createElement("textarea",{ref:"protoText"})," ",r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){return e.handleSubmit()}}," Submit ")):r.a.createElement("button",{onClick:function(){return e.handleStartAdding()}}," Add ")}}]),t}(r.a.Component),_=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleFileChange",value:function(e){var t=e.target.files[0],a=this,n=new FileReader;n.onload=function(){var e=n.result;a.props.callbacks.onAddProto(t.name,e)},n.onerror=function(e){console.error("FileLoading of",t,"failed:",e)},n.readAsText(t)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(){return e.refs.fileuploader.click()}},"From disk"),r.a.createElement("input",{type:"file",ref:"fileuploader",onChange:function(t){return e.handleFileChange(t)},hidden:!0}))}}]),t}(r.a.Component),G=J,K=a(40),W=a(16),H=a(72),Q=a(14),X=Q.List,Y=Q.Map;function Z(e){W.util.isNode=!0,W.util.fs={readFileSync:function(t){var a=e.get(t);if(void 0===a)throw new Error("Needed to load unknown file: "+t);return a.get("contents")}};var t=new W.Root,a=e.keySeq().toList();t.loadSync(a.toJS(),{keepCase:!0});var n=X(a.flatMap(function(t){return(W.parse(e.get(t).get("contents")).imports||[]).map(function(e){return[e,t]})})).groupBy(function(e){var t=Object(h.a)(e,2),a=t[0];t[1];return a}).map(function(e){return e.map(function(e){var t=Object(h.a)(e,2);t[0];return t[1]}).toSet()});return t.resolveAll(),{protoRoot:t,fileDependencies:n}}var ee=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={rawStoredProtos:Y(),protoRoot:null,fileDependencies:Y(),message:Y(),outputFormat:"binary",builtMessage:["",null]},a.libraryCallbacks={onAddProto:a.handleAddProto.bind(Object(d.a)(Object(d.a)(a))),onRemoveProto:a.handleRemoveProto.bind(Object(d.a)(Object(d.a)(a))),onSelectMessageToBuild:a.handleSelectMessageToBuild.bind(Object(d.a)(Object(d.a)(a)))},a.messageBuilderCallbacks={onAdd:a.handleAddToMessage.bind(Object(d.a)(Object(d.a)(a))),onDelete:a.handleDeleteFromMessage.bind(Object(d.a)(Object(d.a)(a))),onSet:a.handleSetInMessage.bind(Object(d.a)(Object(d.a)(a))),onMove:a.handleMoveInMessage.bind(Object(d.a)(Object(d.a)(a))),onSetOutputFormat:a.handleSetOutputFormat.bind(Object(d.a)(Object(d.a)(a))),onBuild:a.handleBuildMessage.bind(Object(d.a)(Object(d.a)(a))),onImport:a.handleImportMessage.bind(Object(d.a)(Object(d.a)(a)))},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleAddProto",value:function(e,t){this.setState(function(a){var n=a.rawStoredProtos.setIn([e],Y({contents:t})),r=Z(n);return{rawStoredProtos:n,protoRoot:r.protoRoot,fileDependencies:r.fileDependencies}})}},{key:"handleRemoveProto",value:function(e){this.setState(function(t){var a=t.rawStoredProtos.delete(e),n=Z(a);return{rawStoredProtos:a,protoRoot:n.protoRoot,fileDependencies:n.fileDependencies}})}},{key:"handleSelectMessageToBuild",value:function(e){console.log("Setting descriptor to build:",e),this.setState({messageToBuild:e,message:Y(),builtMessage:["",null],messageBuildTimer:null})}},{key:"handleSetOutputFormat",value:function(e){this.setState({outputFormat:e,builtMessage:[K.convertTo(e,this.state.messageToBuild,this.state.message),null],messageBuildTimer:null})}},{key:"handleBuildMessage",value:function(e){console.log("Will",e,"as",this.state.outputFormat);var t=K.convertTo(this.state.outputFormat,this.state.messageToBuild,this.state.message);if(console.log("handleBuildMessage",this.refs),"save"===e){var a=K.converterExtension(this.state.outputFormat),n=new Blob([t],{type:"application/octet-stream"});H.saveAs(n,this.state.messageToBuild.name+"."+a)}else console.error("Unhandled build kind:",e)}},{key:"handleImportMessage",value:function(e){console.log("Import",e.length,"bytes as",this.state.outputFormat);var t=K.convertFrom(this.state.outputFormat,this.state.messageToBuild,e);this.setState({message:t,builtMessage:[K.convertTo(this.state.outputFormat,this.state.messageToBuild,t),null],messageBuildTimer:null})}},{key:"handleAddToMessage",value:function(e,t){var a=this;this.setState(function(n){return{message:n.message.updateIn(e,function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:X()).push(t)}),messageBuildTimer:a.scheduleBuildMessage(n.messageBuildTimer)}})}},{key:"handleDeleteFromMessage",value:function(e){var t=this;this.setState(function(a){var n=e.pop(),r=n.last(),s=n.pop();return{message:a.message.deleteIn(e).updateIn(s,function(e){return e.get(r).isEmpty()?e.delete(r):e}),messageBuildTimer:t.scheduleBuildMessage(a.messageBuildTimer)}})}},{key:"handleSetInMessage",value:function(e,t){var a=this;this.setState(function(n){return{message:n.message.setIn(e,t),messageBuildTimer:a.scheduleBuildMessage(n.messageBuildTimer)}})}},{key:"handleMoveInMessage",value:function(e,t,a){var n=this;this.setState(function(r){return{message:r.message.updateIn(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X(),n=e.get(t);return e.delete(t).insert(a,n)}),messageBuildTimer:n.scheduleBuildMessage(r.messageBuildTimer)}})}},{key:"componentDidMount",value:function(){var e=f.load(),t=Z(e),a=t.protoRoot,n=t.fileDependencies,r=b.load();this.setState({rawStoredProtos:e,protoRoot:a,fileDependencies:n,outputFormat:r})}},{key:"componentDidUpdate",value:function(e,t){t.rawStoredProtos!==this.state.rawStoredProtos&&f.save(this.state.rawStoredProtos),t.outputFormat!==this.state.outputFormat&&b.save(this.state.outputFormat)}},{key:"scheduleBuildMessage",value:function(e){var t=this;return clearTimeout(e),setTimeout(function(){return t.setState(function(e){try{return{builtMessage:[K.convertTo(e.outputFormat,e.messageToBuild,e.message),null],messageBuildTimer:null}}catch(t){return{builtMessage:[null,t],messageBuildTimer:null}}})},500)}},{key:"fullMessageDescriptorName",value:function(e){if(!e)return"";for(var t=e.name;e.parent&&e.parent.name;)t=e.parent.name+"."+t,e=e.parent;return t=e.filename+":"+t}},{key:"render",value:function(){return r.a.createElement("div",{className:"protool"},r.a.createElement("div",{className:"message-builder"},r.a.createElement(x,{key:this.fullMessageDescriptorName(this.state.messageToBuild),messageToBuild:this.state.messageToBuild,message:this.state.message,outputFormat:this.state.outputFormat,builtMessage:this.state.builtMessage,buildMessageUpToDate:null===this.state.messageBuildTimer,callbacks:this.messageBuilderCallbacks})),r.a.createElement("div",{className:"proto-library"},r.a.createElement(G,{filenames:this.state.rawStoredProtos.keySeq().toList(),fileDependencies:this.state.fileDependencies,protoRoot:this.state.protoRoot,callbacks:this.libraryCallbacks})))}}]),t}(r.a.Component);a(73);o.a.render(r.a.createElement(ee,null),document.getElementById("root"))}},[[42,2,1]]]);
//# sourceMappingURL=main.dba1d354.chunk.js.map