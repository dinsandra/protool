(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,a){"use strict";a.r(t),a.d(t,"converterFormats",function(){return p}),a.d(t,"converterName",function(){return u}),a.d(t,"converterExtension",function(){return d}),a.d(t,"convertTo",function(){return h}),a.d(t,"convertFrom",function(){return y}),a.d(t,"defaultValueEntryForField",function(){return C}),a.d(t,"messageToProto",function(){return b});var n=a(7),r=a(13),s=r.List,o=r.Map,l=a(15),i=a(38),c={binary:["Binary","pbdata",f,O],"binary-hex":["Binary (hex)","pbdata.hex",function(e,t){var a=f(e,t);return Array.from(a).map(function(e){return(e<16?"0":"")+e.toString(16)}).join("").toUpperCase()},function(e,t){for(var a=[],n=0;n<t.length;n+=2)a.push(parseInt(t.substring(n,n+2),16));return O(e,new Uint8Array(a))}],"binary-b64":["Binary (base64)","pbdata.b64",function(e,t){var a=f(e,t);return l.util.base64.encode(a,0,a.length)},function(e,t){var a=window.atob(t);return O(e,a)}],json:["Json","json",function(e,t){var a=b(e,t);return JSON.stringify(a)},function(e,t){var a=JSON.parse(k(t));return E(e,a)}],"json-camel":["Json (camelCase)","cc.json",function(e,t){var a=b(e,t),n=m(e,e.toObject(a,l.util.toJSONOptions),function(e){return l.util.camelCase(e)});return JSON.stringify(n)},function(e,t){var a=JSON.parse(k(t)),n=j(e,a,function(e){return l.util.camelCase(e)});return E(e,n)}],"json-id":["Json (field-IDs)","ids.json",function(e,t){var a=b(e,t),n=m(e,e.toObject(a,l.util.toJSONOptions),function(e,t){return t.fields[e].id});return JSON.stringify(n)},function(e,t){var a=JSON.parse(k(t)),n=j(e,a,function(e,t){return t.fields[e].id});return E(e,n)}]},p=Object.keys(c).sort();function u(e){return c[e][0]}function d(e){return c[e][1]}function h(e,t,a){return c[e][2](t,a)}function f(e,t){var a=b(e,t);return e.encode(a).finish()}function m(e,t,a){return Object.fromEntries(Object.entries(t).map(function(t){var r=Object(n.a)(t,2),s=r[0],o=r[1],i=a(s,e),c=e.fields[s]||e.fields[i];return c.resolvedType&&c.resolvedType.constructor===l.Type?c.repeated?[i,o.map(function(e){return m(c.resolvedType,e,a)})]:[i,m(c.resolvedType,o,a)]:[i,o]}))}function b(e,t){var a=v(e,t);return e.fromObject(a)}function v(e,t){return t.mapEntries(function(t){var a=Object(n.a)(t,2),r=a[0],s=a[1],o=e.fieldsById[r];return[o.name,function(e,t){return e.map?Object.fromEntries(t.map(function(t){return[g(e.keyType,null,t.get("key")),g(e.type,e.resolvedType,t.get("value"))]}).toArray()):e.repeated?t.map(function(t){return g(e.type,e.resolvedType,t.get("value"))}).toArray():1===t.size?g(e.type,e.resolvedType,t.get(0).get("value")):null}(o,s)]}).toObject()}function g(e,t,a){switch(e){case"string":case"bytes":case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":case"float":case"double":case"bool":return a}return null===t?(console.error("Unhandled value type",e),""):t.constructor===l.Enum?a:t.constructor===l.Type?v(t,a):(console.error("Unhandled value type",e),"")}function y(e,t,a){return c[e][3](t,a)}function O(e,t){var a=e.decode(t);return E(e,a,{binary:!0})}function k(e){return e instanceof Uint8Array?new TextDecoder("utf-8").decode(e):e}function j(e,t,a){return m(e,t,function(e,t){return function(e,t,a){for(var n in t.fields)if(a(n,t).toString()===e)return n;for(var r in console.error("Failed to match key"),t.fields)console.error("tried",a(r,t),"===",e);console.error("all false.")}(e,t,a)})}function E(e,t,a){return o(Object.entries(t).map(function(t){var r=Object(n.a)(t,2),l=r[0],c=r[1],p=e.fields[l];return[p.id,function(e,t,a){if(e.map)return s(Object.entries(t).map(function(t){var a=Object(n.a)(t,2),r=a[0],s=a[1];return{id:i.generate(),key:D(e.keyType,null,r),value:D(e.type,e.resolvedType,s)}}));var r=e.repeated?t:[t];return s(r.map(function(t){return o({id:i.generate(),value:D(e,t,a)})}))}(p,c,a)]}))}function D(e,t,a){switch(e.type){case"bytes":return a&&a.binary?l.util.base64.encode(t,0,t.length):t;case"string":case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":case"float":case"double":case"bool":return t}var n=e.resolvedType;return null===n?(console.error("Unhandled value type",e),""):n.constructor===l.Enum?t:n.constructor===l.Type?E(n,t,a):(console.error("Unhandled value type",e),"")}function C(e){var t={id:i.generate(),value:S(e.type,e.resolvedType)};return e.map&&(t.key=S(e.keyType,null)),o(t)}function S(e,t){switch(e){case"string":case"bytes":return"";case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":case"float":case"double":return"0";case"bool":return!1}return null===t?(console.error("Unhandled default type, expected resolved type",e),""):t.constructor===l.Enum?parseInt(s(Object.keys(t.valuesById)).sort().first(),10):t.constructor===l.Type?o():(console.error("Unhandled default type",e),"")}},41:function(e,t,a){e.exports=a(74)},72:function(e,t,a){},74:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(40),o=a.n(s),l=a(1),i=a(2),c=a(4),p=a(3),u=a(5),d=a(7),h=a(13).fromJS,f={load:function(){var e=h(JSON.parse(window.localStorage.getItem("stored_protos")||"{}"));return console.log("rawStoredProtos",e),e},save:function(e){e.isEmpty()?(console.log("REMOVING:",e.toJSON()),window.localStorage.removeItem("stored_protos")):(console.log("SAVING:",e.toJSON()),window.localStorage.setItem("stored_protos",JSON.stringify(e.toJSON())))}},m={load:function(){return window.localStorage.getItem("format")||"binary"},save:function(e){"binary"===e?window.localStorage.removeItem("format"):window.localStorage.setItem("format",e)}},b=a(15),v=a(38),g=a(39),y=a(13).List,O=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return void 0===this.props.messageDescriptor?null:r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,this.props.messageDescriptor.name," builder"),r.a.createElement(j,{path:y(),messageDescriptor:this.props.messageDescriptor,values:this.props.message,callbacks:this.props.callbacks}),r.a.createElement(k,{messageDescriptor:this.props.messageDescriptor,format:this.props.format,builtMessage:this.props.builtMessage,buildMessageUpToDate:this.props.buildMessageUpToDate,callbacks:this.props.callbacks}))}}]),t}(r.a.Component),k=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleExportToFile=function(){return a.props.callbacks.onExport("file")},a.handleChangeFormat=function(e){return a.props.callbacks.onSetFormat(e.target.value)},a.handleFileChange=function(e){var t=e.target.files[0],n=new FileReader;n.onload=function(){var e=new Uint8Array(n.result);a.props.callbacks.onImport(e)},n.onerror=function(e){return console.error("FileLoading of",t,"failed:",e)},n.readAsArrayBuffer(t)},a.handleImportFromFile=function(){return a.refs.fileuploader.click()},a.handleChangeBuiltMessage=function(e){var t="binary"===a.props.format?new Uint8Array(e.target.value.split(",")):e.target.value;a.props.callbacks.onImport(t)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.builtMessage[0],t=null===e?this.props.builtMessage[1]:null;return r.a.createElement(r.a.Fragment,null,"Format:",r.a.createElement("select",{onChange:this.handleChangeFormat,defaultValue:this.props.format},g.converterFormats.map(function(e){return r.a.createElement("option",{key:e,value:e},g.converterName(e))})),r.a.createElement("br",null),"import",r.a.createElement("button",{onClick:this.handleImportFromFile},"Load from file"),r.a.createElement("input",{type:"file",ref:"fileuploader",onChange:this.handleFileChange,hidden:!0}),r.a.createElement("br",null),"export",r.a.createElement("button",{onClick:this.handleExportToFile}," Save as file "),r.a.createElement("br",null),r.a.createElement("textarea",{value:t||e,cols:"200",rows:"3",className:null===e?"invalid":"",disabled:!this.props.buildMessageUpToDate,onChange:this.handleChangeBuiltMessage}))}}]),t}(r.a.Component),j=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).isRegularField=function(e){return null===e.partOf},a.fieldTypeName=function(e){var t=e.type;return e.map?"map<"+e.keyType+","+t+">":t+(e.repeated?"*":"")+(e.required?"!":"")},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=Object.values(this.props.messageDescriptor.fields).filter(this.isRegularField),a=Object.values(this.props.messageDescriptor.oneofs||{}),n=t.map(function(t){return r.a.createElement("li",{key:t.name},r.a.createElement("b",null,e.fieldTypeName(t))," - ",t.name," = ",t.id,r.a.createElement(E,{path:e.props.path.concat([t.id]),fieldDescriptor:t,valueEntries:e.props.values.get(t.id)||y(),callbacks:e.props.callbacks}))}),s=a.map(function(t){return r.a.createElement("li",{key:t.name},r.a.createElement("b",null,"oneof")," ",t.name,r.a.createElement(C,{path:e.props.path,messageDescriptor:e.props.messageDescriptor,oneOfDescriptor:t,values:e.props.values,callbacks:e.props.callbacks}))});return r.a.createElement("ul",null,n,s)}}]),t}(r.a.Component),E=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleSet=function(){a.props.callbacks.onAdd(a.props.path,g.defaultValueEntryForField(a.props.fieldDescriptor))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=0===this.props.valueEntries.size,a=this.props.fieldDescriptor.repeated||this.props.fieldDescriptor.map;return r.a.createElement("ul",null,this.props.valueEntries.map(function(t,a){return r.a.createElement(D,{key:t.get("id"),path:e.props.path,index:a,numEntries:e.props.valueEntries.size,fieldDescriptor:e.props.fieldDescriptor,valueEntry:t,callbacks:e.props.callbacks})}),(a||t)&&r.a.createElement("li",null,r.a.createElement("button",{onClick:this.handleSet}," ",a?"add":"set"," ")))}}]),t}(r.a.Component),D=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleDelete=function(){return a.props.callbacks.onDelete(a.props.path.concat([a.props.index]))},a.handleDuplicate=function(){a.props.callbacks.onAdd(a.props.path,a.props.valueEntry.set("id",v.generate()))},a.handleMoveUp=function(){a.props.callbacks.onMove(a.props.path,a.props.index,a.props.index-1)},a.handleMoveDown=function(){a.props.callbacks.onMove(a.props.path,a.props.index,a.props.index+1)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=null===this.props.fieldDescriptor.partOf,t=this.props.fieldDescriptor.repeated||this.props.fieldDescriptor.map,a=this.props.fieldDescriptor.repeated,n=this.props.index!==this.props.numEntries-1,s=0!==this.props.index;return r.a.createElement("li",{key:this.props.valueEntry.get("id")},r.a.createElement("button",{onClick:this.handleDelete,hidden:!e,className:"tiny"},"-"),r.a.createElement("button",{onClick:this.handleDuplicate,hidden:!t,className:"tiny"},"*"),r.a.createElement("button",{onClick:this.handleMoveDown,hidden:!a,disabled:!n,className:"tiny"},"v"),r.a.createElement("button",{onClick:this.handleMoveUp,hidden:!a,disabled:!s,className:"tiny"},"^"),this.props.fieldDescriptor.map?r.a.createElement(S,{path:this.props.path.concat([this.props.index,"key"]),fieldType:this.props.fieldDescriptor.keyType,resolvedType:null,value:this.props.valueEntry.get("key"),callbacks:this.props.callbacks}):r.a.createElement(r.a.Fragment,null),r.a.createElement(S,{path:this.props.path.concat([this.props.index,"value"]),fieldType:this.props.fieldDescriptor.type,resolvedType:this.props.fieldDescriptor.resolvedType,value:this.props.valueEntry.get("value"),callbacks:this.props.callbacks}))}}]),t}(r.a.Component),C=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).currentFieldDescriptor=function(){var e=a.props.values.keySeq().find(function(e){return a.props.messageDescriptor.fieldsById[e].partOf===a.props.oneOfDescriptor});return void 0===e?null:a.props.messageDescriptor.fieldsById[e]},a.onChange=function(e){var t=a.currentFieldDescriptor();if(null!==t&&a.props.callbacks.onDelete(a.props.path.concat([t.id,0])),0!==e.target.value.length){var n=parseInt(e.target.value,10),r=a.props.messageDescriptor.fieldsById[n];a.props.callbacks.onAdd(a.props.path.concat([r.id]),g.defaultValueEntryForField(r))}},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.currentFieldDescriptor();return console.log("MessageOneOfFieldValuesBuilder",e),r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("select",{value:null!==e?e.id:"",onChange:this.onChange},r.a.createElement("option",{value:""}),this.props.oneOfDescriptor.fieldsArray.map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.type," - ",e.name," = ",e.id)})),null!==e?r.a.createElement(E,{path:this.props.path.concat([e.id]),fieldDescriptor:e,valueEntries:this.props.values.get(e.id)||y(),callbacks:this.props.callbacks}):r.a.createElement(r.a.Fragment,null))))}}]),t}(r.a.Component),S=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){switch(this.props.fieldType){case"string":return r.a.createElement(w,{path:this.props.path,value:this.props.value,callbacks:this.props.callbacks});case"bytes":return r.a.createElement(T,{path:this.props.path,value:this.props.value,callbacks:this.props.callbacks});case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":return r.a.createElement(M,{path:this.props.path,value:this.props.value,callbacks:this.props.callbacks});case"float":case"double":return r.a.createElement(F,{path:this.props.path,value:this.props.value,callbacks:this.props.callbacks});case"bool":return r.a.createElement(x,{path:this.props.path,value:this.props.value,callbacks:this.props.callbacks})}var e=this.props.resolvedType;return e.constructor===b.Enum?r.a.createElement(A,{path:this.props.path,type:e,value:this.props.value,callbacks:this.props.callbacks}):e.constructor===b.Type?r.a.createElement(j,{path:this.props.path,messageDescriptor:e,values:this.props.value,callbacks:this.props.callbacks}):(console.error("Unhandled input type",this.props.fieldType),r.a.createElement("div",null))}}]),t}(r.a.Component),w=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){a.props.callbacks.onSet(a.props.path,e.target.value)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("textarea",{onChange:this.handleChange,value:this.props.value})}}]),t}(r.a.Component),T=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).isValid=function(){return b.util.base64.test(a.props.value)},a.handleChange=function(e){a.props.callbacks.onSet(a.props.path,e.target.value)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.isValid();return r.a.createElement("textarea",{onChange:this.handleChange,value:this.props.value,className:e?"":"invalid"})}}]),t}(r.a.Component),M=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).isValid=function(){return/^[0-9]+$/.test(a.props.value)},a.handleChange=function(e){a.props.callbacks.onSet(a.props.path,e.target.value)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.isValid();return r.a.createElement("input",{type:"text",onChange:this.handleChange,value:this.props.value,className:e?"":"invalid"})}}]),t}(r.a.Component),F=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).isValid=function(){return/^[0-9]+$|^[0-9]+[.][0-9]*$|^[0-9]*[.][0-9]+$/.test(a.props.value)},a.handleChange=function(e){a.props.callbacks.onSet(a.props.path,e.target.value)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.isValid();return r.a.createElement("input",{type:"text",onChange:this.handleChange,value:this.props.value,className:e?"":"invalid"})}}]),t}(r.a.Component),x=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){a.props.callbacks.onSet(a.props.path,e.target.checked)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("input",{type:"checkbox",checked:this.props.value,onChange:this.handleChange})}}]),t}(r.a.Component),A=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){var t=parseInt(e.target.value);a.props.callbacks.onSet(a.props.path,t)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=y(Object.keys(this.props.type.valuesById)).sort();return r.a.createElement("select",{defaultValue:this.props.value,onChange:this.handleChange},t.map(function(t){return r.a.createElement("option",{value:t,key:t},e.props.type.valuesById[t]," = ",t)}))}}]),t}(r.a.Component),B=O,I=a(15),N=a(13).List,R=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Known namespaces and messages"),r.a.createElement(P,{protoRoot:this.props.protoRoot,callbacks:this.props.callbacks}),r.a.createElement("h2",null,"Known files"),r.a.createElement(V,{filenames:this.props.filenames,fileDependencies:this.props.fileDependencies,callbacks:this.props.callbacks}),r.a.createElement(q,{callbacks:this.props.callbacks}),r.a.createElement($,{callbacks:this.props.callbacks}))}}]),t}(r.a.Component),P=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.protoRoot?r.a.createElement(J,{name:"",namespace:this.props.protoRoot,callbacks:this.props.callbacks}):r.a.createElement(r.a.Fragment,null)}}]),t}(r.a.Component),J=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleBuild=function(){return a.props.callbacks.onSelectMessageDescriptor(a.props.namespace)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,a=this.props.namespace.nested||{},n=Object.entries(a),s=n.filter(function(e){var t=Object(d.a)(e,2);t[0];return t[1].constructor===I.Namespace}),o=n.filter(function(e){var t=Object(d.a)(e,2);t[0];return t[1].constructor===I.Type});if(this.props.namespace.constructor===I.Namespace){var l=this.props.name?this.props.name+".":"";if(1===s.length&&0===o.length){var i=Object(d.a)(s[0],2),c=i[0],p=i[1];return r.a.createElement(t,{name:l+c,namespace:p,callbacks:this.props.callbacks})}if(0===s.length&&1===o.length){var u=Object(d.a)(o[0],2),h=u[0],f=u[1];return r.a.createElement(U,{name:l+h,message:f,callbacks:this.props.callbacks})}}return r.a.createElement(r.a.Fragment,null,this.props.name,r.a.createElement("button",{onClick:this.handleBuild,hidden:!this.props.buildable},"build"),r.a.createElement("ul",null,s.map(function(a){var n=Object(d.a)(a,2),s=n[0],o=n[1];return r.a.createElement("li",{key:s},r.a.createElement(t,{name:s,namespace:o,callbacks:e.props.callbacks}))}),o.map(function(t){var a=Object(d.a)(t,2),n=a[0],s=a[1];return r.a.createElement("li",{key:n},r.a.createElement(U,{name:n,message:s,callbacks:e.props.callbacks}))})))}}]),t}(r.a.Component),U=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(J,{name:this.props.name,namespace:this.props.message,buildable:!0,callbacks:this.props.callbacks})}}]),t}(r.a.Component),V=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("ul",null,this.props.filenames.sort().map(function(t){return r.a.createElement("li",{key:t},r.a.createElement(L,{filename:t,fileDependencies:e.props.fileDependencies,callbacks:e.props.callbacks}))}))}}]),t}(r.a.Component),L=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){a.props.callbacks.onRemoveProto(a.props.filename)},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.fileDependencies.get(this.props.filename,N()),t=e.isEmpty()?r.a.createElement(r.a.Fragment,null):r.a.createElement(V,{filenames:e,fileDependencies:this.props.fileDependencies,callbacks:this.props.callbacks});return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.handleClick,disabled:!e.isEmpty(),className:"tiny"},"-"),this.props.filename,t)}}]),t}(r.a.Component),q=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).handleStartAdding=function(){return a.setState({isAdding:!0})},a.handleSubmit=function(){var e=a.refs.fileName.value,t=a.refs.protoText.value;a.setState({isAdding:!1}),a.props.callbacks.onAddProto(e,t)},a.state={isAdding:!1},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.state.isAdding?r.a.createElement(r.a.Fragment,null,"File name: ",r.a.createElement("input",{type:"text",ref:"fileName"})," ",r.a.createElement("br",null),"ProtoContent: ",r.a.createElement("br",null),r.a.createElement("textarea",{ref:"protoText"})," ",r.a.createElement("br",null),r.a.createElement("button",{onClick:this.handleSubmit}," Submit ")):r.a.createElement("button",{onClick:this.handleStartAdding}," Add ")}}]),t}(r.a.Component),$=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleFileChange=function(e){var t=e.target.files[0],n=new FileReader;n.onload=function(){var e=n.result;a.props.callbacks.onAddProto(t.name,e)},n.onerror=function(e){console.error("FileLoading of",t,"failed:",e)},n.readAsText(t)},a.handleClick=function(){return a.refs.fileuploader.click()},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.handleClick},"From disk"),r.a.createElement("input",{type:"file",ref:"fileuploader",onChange:this.handleFileChange,hidden:!0}))}}]),t}(r.a.Component),z=R,_=a(39),G=a(15),K=a(71),H=a(13),Q=H.List,W=H.Map;function X(e){G.util.isNode=!0,G.util.fs={readFileSync:function(t){var a=e.get(t);if(void 0===a)throw new Error("Needed to load unknown file: "+t);return a.get("contents")}};var t=new G.Root,a=e.keySeq().toList();t.loadSync(a.toJS(),{keepCase:!0});var n=Q(a.flatMap(function(t){return(G.parse(e.get(t).get("contents")).imports||[]).map(function(e){return[e,t]})})).groupBy(function(e){var t=Object(d.a)(e,2),a=t[0];t[1];return a}).map(function(e){return e.map(function(e){var t=Object(d.a)(e,2);t[0];return t[1]}).toSet()});return t.resolveAll(),{protoRoot:t,fileDependencies:n}}var Y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).handleAddProto=function(e,t){a.setState(function(a){var n=a.rawStoredProtos.setIn([e],W({contents:t})),r=X(n);return{rawStoredProtos:n,protoRoot:r.protoRoot,fileDependencies:r.fileDependencies}})},a.handleRemoveProto=function(e){a.setState(function(t){var a=t.rawStoredProtos.delete(e),n=X(a);return{rawStoredProtos:a,protoRoot:n.protoRoot,fileDependencies:n.fileDependencies}})},a.handleSelectMessageDescriptor=function(e){console.log("Setting descriptor to build:",e),a.setState({messageDescriptor:e,message:W(),builtMessage:["",null],messageBuildTimer:null})},a.handleSetFormat=function(e){a.setState({format:e,builtMessage:[_.convertTo(e,a.state.messageDescriptor,a.state.message),null],messageBuildTimer:null})},a.handleExportMessage=function(e){console.log("Export",a.state.format,"to",e);var t=_.convertTo(a.state.format,a.state.messageDescriptor,a.state.message);if(console.log("handleExportMessage",a.refs),"file"===e){var n=_.converterExtension(a.state.format),r=new Blob([t],{type:"application/octet-stream"});K.saveAs(r,a.state.messageDescriptor.name+"."+n)}else console.error("Unhandled export kind:",e)},a.handleImportMessage=function(e){console.log("Import",e.length,"bytes as",a.state.format);var t=_.convertFrom(a.state.format,a.state.messageDescriptor,e);a.setState({message:t,builtMessage:[_.convertTo(a.state.format,a.state.messageDescriptor,t),null],messageBuildTimer:null})},a.handleAddToMessage=function(e,t){a.setState(function(n){return{message:n.message.updateIn(e,function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q()).push(t)}),messageBuildTimer:a.scheduleBuildMessage(n.messageBuildTimer)}})},a.handleDeleteFromMessage=function(e){a.setState(function(t){var n=e.pop(),r=n.last(),s=n.pop();return{message:t.message.deleteIn(e).updateIn(s,function(e){return e.get(r).isEmpty()?e.delete(r):e}),messageBuildTimer:a.scheduleBuildMessage(t.messageBuildTimer)}})},a.handleSetInMessage=function(e,t){a.setState(function(n){return{message:n.message.setIn(e,t),messageBuildTimer:a.scheduleBuildMessage(n.messageBuildTimer)}})},a.handleMoveInMessage=function(e,t,n){a.setState(function(r){return{message:r.message.updateIn(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q(),a=e.get(t);return e.delete(t).insert(n,a)}),messageBuildTimer:a.scheduleBuildMessage(r.messageBuildTimer)}})},a.scheduleBuildMessage=function(e){return clearTimeout(e),setTimeout(function(){return a.setState(function(e){try{return{builtMessage:[_.convertTo(e.format,e.messageDescriptor,e.message),null],messageBuildTimer:null}}catch(t){return{builtMessage:[null,t],messageBuildTimer:null}}})},500)},a.fullMessageDescriptorName=function(e){if(!e)return"";for(var t=e.name;e.parent&&e.parent.name;)t=e.parent.name+"."+t,e=e.parent;return t=e.filename+":"+t},a.state={rawStoredProtos:W(),protoRoot:null,fileDependencies:W(),message:W(),format:"binary",builtMessage:["",null]},a.libraryCallbacks={onAddProto:a.handleAddProto,onRemoveProto:a.handleRemoveProto,onSelectMessageDescriptor:a.handleSelectMessageDescriptor},a.messageBuilderCallbacks={onAdd:a.handleAddToMessage,onDelete:a.handleDeleteFromMessage,onSet:a.handleSetInMessage,onMove:a.handleMoveInMessage,onSetFormat:a.handleSetFormat,onExport:a.handleExportMessage,onImport:a.handleImportMessage},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=f.load(),t=X(e),a=t.protoRoot,n=t.fileDependencies,r=m.load();this.setState({rawStoredProtos:e,protoRoot:a,fileDependencies:n,format:r})}},{key:"componentDidUpdate",value:function(e,t){t.rawStoredProtos!==this.state.rawStoredProtos&&f.save(this.state.rawStoredProtos),t.format!==this.state.format&&m.save(this.state.format)}},{key:"render",value:function(){return r.a.createElement("div",{className:"protool"},r.a.createElement("div",{className:"message-builder"},r.a.createElement(B,{key:this.fullMessageDescriptorName(this.state.messageDescriptor),messageDescriptor:this.state.messageDescriptor,message:this.state.message,format:this.state.format,builtMessage:this.state.builtMessage,buildMessageUpToDate:null===this.state.messageBuildTimer,callbacks:this.messageBuilderCallbacks})),r.a.createElement("div",{className:"proto-library"},r.a.createElement(z,{filenames:this.state.rawStoredProtos.keySeq().toList(),fileDependencies:this.state.fileDependencies,protoRoot:this.state.protoRoot,callbacks:this.libraryCallbacks})))}}]),t}(r.a.Component);a(72);o.a.render(r.a.createElement(Y,null),document.getElementById("root"))}},[[41,2,1]]]);
//# sourceMappingURL=main.4e791250.chunk.js.map