(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,a){"use strict";a.r(t),a.d(t,"converterFormats",function(){return c}),a.d(t,"converterName",function(){return u}),a.d(t,"convert",function(){return p}),a.d(t,"defaultValueForField",function(){return v}),a.d(t,"messageToProto",function(){return m});var n=a(7),s=a(15),r=a(14),o=r.List,l=r.Map,i={binary:["Binary",h],"binary-hex":["Binary (hex)",function(e,t){var a=h(e,t);return Array.from(a).map(function(e){return(e<16?"0":"")+e.toString(16)}).join("").toUpperCase()}],"binary-b64":["Binary (base64)",function(e,t){var a=h(e,t);return s.util.base64.encode(a,0,a.length)}],json:["Json",function(e,t){var a=m(e,t);return JSON.stringify(a)}],"json-camel":["Json (camelCase)",function(e,t){var a=m(e,t),n=d(e,a,function(e){return s.util.camelCase(e)});return JSON.stringify(n)}],"json-id":["Json (field-IDs)",function(e,t){var a=m(e,t),n=d(e,a,function(e,t){return t.id});return JSON.stringify(n)}]},c=Object.keys(i).sort();function u(e){return i[e][0]}function p(e,t,a){return i[e][1](t,a)}function h(e,t){var a=m(e,t);return e.encode(a).finish()}function d(e,t,a){return Object.fromEntries(Object.entries(t).map(function(t){var r=Object(n.a)(t,2),o=r[0],l=r[1],i=e.fields[o],c=a(o,i);return i.resolvedType&&i.resolvedType.constructor===s.Type?i.repeated?[c,l.map(function(e){return d(i.resolvedType,e,a)})]:[c,d(i.resolvedType,l,a)]:[c,l]}))}function m(e,t){var a=f(e,t);return e.fromObject(a)}function f(e,t){return t.mapEntries(function(t){var a=Object(n.a)(t,2),s=a[0],r=a[1],o=e.fieldsById[s];return[o.name,function(e,t){return e.repeated?t.map(function(t){return b(e,t.get("value"))}).toArray():1===t.size?b(e,t.get(0).get("value")):null}(o,r)]}).toObject()}function b(e,t){switch(e.type){case"string":case"bytes":return t;case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":case"float":case"double":case"bool":return t}var a=e.resolvedType;return null===a?(console.log("Unhandled value type",e),""):a.constructor===s.Enum?t:a.constructor===s.Type?f(a,t):(console.log("Unhandled value type",e),"")}function v(e){switch(e.type){case"string":case"bytes":return"";case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":case"float":case"double":return"0";case"bool":return!1}var t=e.resolvedType;return null===t?(console.log("Unhandled default type",e),""):t.constructor===s.Enum?parseInt(o(Object.keys(t.valuesById)).sort().first(),10):t.constructor===s.Type?l():(console.log("Unhandled default type",e),"")}},39:function(e,t,a){e.exports=a(73)},71:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(38),o=a.n(r),l=a(1),i=a(2),c=a(4),u=a(3),p=a(5),h=a(14).fromJS;var d={loadProtosFromStorage:function(){var e=h(JSON.parse(window.localStorage.getItem("stored_protos")||"{}"));return console.log("rawStoredProtos",e),e},saveProtosToStorage:function(e){console.log("SAVING:",e.toJSON()),window.localStorage.setItem("stored_protos",JSON.stringify(e.toJSON()))}},m=a(7),f=a(15),b=a(62),v=a(37),g=a(14),k=g.List,y=g.Map,O=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return void 0===this.props.messageToBuild?null:s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",null,this.props.messageToBuild.name," builder"),s.a.createElement(E,{path:k(),fields:this.props.messageToBuild.fields,values:this.props.message,callbacks:this.props.callbacks}),s.a.createElement(j,{builtMessage:this.props.builtMessage,buildMessageUpToDate:this.props.buildMessageUpToDate,callbacks:this.props.callbacks}))}}]),t}(s.a.Component),j=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChangeOutputFormat",value:function(e){this.props.callbacks.onSetOutputFormat(e.target.value)}},{key:"handleBuild",value:function(e){this.props.callbacks.onBuild(e)}},{key:"render",value:function(){var e=this,t=this.handleChangeOutputFormat.bind(this),a=function(t){return function(){return e.handleBuild(t)}};return s.a.createElement(s.a.Fragment,null,s.a.createElement("select",{onChange:t},v.converterFormats.map(function(e){return s.a.createElement("option",{key:e,value:e},v.converterName(e))})),s.a.createElement("button",{onClick:a("copy")}," Copy "),s.a.createElement("button",{onClick:a("save")}," Save as file "),s.a.createElement("br",null),s.a.createElement("textarea",{value:this.props.builtMessage,cols:"200",rows:"3",readOnly:!0,disabled:!this.props.buildMessageUpToDate}))}}]),t}(s.a.Component),E=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("ol",null,Object.entries(this.props.fields).map(function(t){var a=Object(m.a)(t,2),n=a[0],r=a[1];return s.a.createElement("li",{key:n,value:r.id},s.a.createElement("b",null,r.type)," - ",r.name,s.a.createElement(S,{path:e.props.path.concat([r.id]),field:r,valueEntries:e.props.values.get(r.id)||k(),callbacks:e.props.callbacks}))}))}}]),t}(s.a.Component),S=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleSet",value:function(){this.props.callbacks.onAdd(this.props.path,y({id:b.generate(),value:v.defaultValueForField(this.props.field)}))}},{key:"handleDelete",value:function(e){this.props.callbacks.onDelete(this.props.path.concat([e]))}},{key:"handleDuplicate",value:function(e){this.props.callbacks.onAdd(this.props.path,e.set("id",b.generate()))}},{key:"handleMoveUp",value:function(e){this.props.callbacks.onMove(this.props.path,e,e-1)}},{key:"handleMoveDown",value:function(e){this.props.callbacks.onMove(this.props.path,e,e+1)}},{key:"render",value:function(){var e=this,t=0===this.props.valueEntries.size,a=this.props.field.repeated,n=this.props.field.repeated,r=this.props.field.repeated;return s.a.createElement("ul",null,this.props.valueEntries.map(function(t,a){var o=a!==e.props.valueEntries.size-1,l=0!==a;return s.a.createElement("li",{key:t.get("id")},s.a.createElement("button",{onClick:function(){return e.handleDelete(a)}}," - "),s.a.createElement("button",{onClick:function(){return e.handleDuplicate(t)},hidden:!n},"*"),s.a.createElement("button",{onClick:function(){return e.handleMoveDown(a)},hidden:!r,disabled:!o},"v"),s.a.createElement("button",{onClick:function(){return e.handleMoveUp(a)},hidden:!r,disabled:!l},"^"),s.a.createElement(C,{path:e.props.path.concat([a,"value"]),field:e.props.field,value:t.get("value"),callbacks:e.props.callbacks}))}),(a||t)&&s.a.createElement("li",null,s.a.createElement("button",{onClick:function(){return e.handleSet()}}," ",a?"add":"set"," ")))}}]),t}(s.a.Component),C=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){switch(this.props.field.type){case"string":return s.a.createElement(M,{path:this.props.path,field:this.props.field,value:this.props.value,callbacks:this.props.callbacks});case"bytes":return s.a.createElement(T,{path:this.props.path,field:this.props.field,value:this.props.value,callbacks:this.props.callbacks});case"int32":case"int64":case"sint32":case"sint64":case"uint32":case"uint64":case"fixed32":case"fixed64":case"float":case"double":return s.a.createElement(B,{path:this.props.path,field:this.props.field,value:this.props.value,callbacks:this.props.callbacks});case"bool":return s.a.createElement(F,{path:this.props.path,field:this.props.field,value:this.props.value,callbacks:this.props.callbacks})}var e=this.props.field.resolvedType;return e.constructor===f.Enum?s.a.createElement(P,{path:this.props.path,field:this.props.field,type:e,value:this.props.value,callbacks:this.props.callbacks}):e.constructor===f.Type?s.a.createElement(E,{path:this.props.path,fields:e.fields,values:this.props.value,callbacks:this.props.callbacks}):(console.log("Unhandled input type",this.props.field.type),s.a.createElement("div",null))}}]),t}(s.a.Component),M=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.props.callbacks.onSet(this.props.path,e.target.value)}},{key:"render",value:function(){var e=this;return s.a.createElement("textarea",{onChange:function(t){return e.handleChange(t)},value:this.props.value})}}]),t}(s.a.Component),T=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.props.callbacks.onSet(this.props.path,e.target.value)}},{key:"render",value:function(){var e=this;return s.a.createElement("textarea",{onChange:function(t){return e.handleChange(t)},value:this.props.value})}}]),t}(s.a.Component),B=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.props.callbacks.onSet(this.props.path,e.target.value)}},{key:"render",value:function(){var e=this;return s.a.createElement("input",{type:"text",onChange:function(t){return e.handleChange(t)},value:this.props.value})}}]),t}(s.a.Component),F=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){console.log("MessageBoolInput",this.props.path,e.target.checked),this.props.callbacks.onSet(this.props.path,e.target.checked)}},{key:"render",value:function(){var e=this;return s.a.createElement("input",{type:"checkbox",checked:this.props.value,onChange:function(t){return e.handleChange(t)}})}}]),t}(s.a.Component),P=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){var t=parseInt(e.target.value);console.log("MessageEnumInput.change",this.props.path,typeof t,t),this.props.callbacks.onSet(this.props.path,t)}},{key:"render",value:function(){var e=this,t=k(Object.keys(this.props.type.valuesById)).sort();return s.a.createElement("select",{defaultValue:this.props.value,onChange:function(t){return e.handleChange(t)}},t.map(function(t){return s.a.createElement("option",{value:t,key:t},e.props.type.valuesById[t]," = ",t)}).toJS())}}]),t}(s.a.Component),w=O,I=a(15),A=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,a=this.props.namespace.nested||{},n=Object.entries(a),r=n.filter(function(e){var t=Object(m.a)(e,2);t[0];return t[1].constructor===I.Namespace}),o=n.filter(function(e){var t=Object(m.a)(e,2);t[0];return t[1].constructor===I.Type});return s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{onClick:function(){return e.props.callbacks.onRemoveProto(e.props.name)},hidden:!this.props.removable},"-"),this.props.name,s.a.createElement("button",{onClick:function(){return e.props.callbacks.onSelectMessageToBuild(e.props.namespace)},hidden:!this.props.buildable},"build"),s.a.createElement("ul",null,r.map(function(a){var n=Object(m.a)(a,2),r=n[0],o=n[1];return s.a.createElement("li",{key:r},s.a.createElement(t,{file:e.props.file,name:r,namespace:o,callbacks:e.props.callbacks}))}),o.map(function(t){var a=Object(m.a)(t,2),n=a[0],r=a[1];return s.a.createElement("li",{key:n},s.a.createElement(x,{file:e.props.file,message:r,callbacks:e.props.callbacks}))})))}}]),t}(s.a.Component),x=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement(A,{file:this.props.file,name:this.props.message.name,namespace:this.props.message,buildable:!0,callbacks:this.props.callbacks})}}]),t}(s.a.Component),D=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement(A,{file:this.props.name,name:this.props.name,namespace:this.props.contents.root,removable:!0,callbacks:this.props.callbacks})}}]),t}(s.a.Component),N=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",null,"Proto library"),s.a.createElement("ul",null,this.props.protoFiles.entrySeq().map(function(t){var a=Object(m.a)(t,2),n=a[0],r=a[1];return s.a.createElement("li",{key:n},s.a.createElement(D,{name:n,contents:r.get("contents"),callbacks:e.props.callbacks}))}).toJS()),s.a.createElement(U,{callbacks:this.props.callbacks}),s.a.createElement(J,{callbacks:this.props.callbacks}))}}]),t}(s.a.Component),U=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isAdding:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleStartAdding",value:function(){this.setState({isAdding:!0})}},{key:"handleSubmit",value:function(){var e=this.refs.fileName.value,t=this.refs.protoText.value;this.setState({isAdding:!1}),this.props.callbacks.onAddProto(e,t)}},{key:"render",value:function(){var e=this;return this.state.isAdding?s.a.createElement(s.a.Fragment,null,"File name: ",s.a.createElement("input",{type:"text",ref:"fileName"})," ",s.a.createElement("br",null),"ProtoContent: ",s.a.createElement("br",null),s.a.createElement("textarea",{ref:"protoText"})," ",s.a.createElement("br",null),s.a.createElement("button",{onClick:function(){return e.handleSubmit()}}," Submit ")):s.a.createElement("button",{onClick:function(){return e.handleStartAdding()}}," Add ")}}]),t}(s.a.Component),J=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleFileChange",value:function(e){var t=e.target.files[0],a=this,n=new FileReader;n.onload=function(){var e=n.result;a.props.callbacks.onAddProto(t.name,e)},n.onerror=function(e){console.log("FileLoading of",t,"failed:",e)},n.readAsText(t)}},{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{onClick:function(){return e.refs.fileuploader.click()}},"From disk"),s.a.createElement("input",{type:"file",ref:"fileuploader",onChange:function(t){return e.handleFileChange(t)},hidden:!0}))}}]),t}(s.a.Component),R=N,L=a(37),V=a(15),z=a(14),_=z.List,q=z.Map;function G(e,t){return console.log("protobuf",V),e.updateIn(["contents"],function(e){V.parse.filename=t;var a=V.parse(e,{keepCase:!0});return a.root.resolveAll(),a})}var W=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={rawStoredProtos:q(),storedProtos:q(),message:q(),outputFormat:"binary",builtMessage:""},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleAddProto",value:function(e,t){var a=V.parse(t,{keepCase:!0});this.setState(function(n){return{rawStoredProtos:n.rawStoredProtos.setIn([e],q({contents:t})),storedProtos:n.storedProtos.setIn([e],q({contents:a}))}})}},{key:"handleRemoveProto",value:function(e){this.setState(function(t){return{rawStoredProtos:t.rawStoredProtos.delete(e),storedProtos:t.storedProtos.delete(e)}})}},{key:"handleSelectMessageToBuild",value:function(e){this.setState({messageToBuild:e,message:q(),builtMessage:"",messageBuildTimer:null})}},{key:"handleSetOutputFormat",value:function(e){this.setState({outputFormat:e,builtMessage:L.convert(e,this.state.messageToBuild,this.state.message)})}},{key:"handleBuildMessage",value:function(e){console.log("Will",e,"as",this.state.outputFormat);var t=this.buildMessage();if("copy"===e);else if("save"===e){var a=new Blob([t],{type:"application/octet-stream"});window.location=window.URL.createObjectURL(a)}else console.log("Unhandled build kind:",e)}},{key:"handleAddToMessage",value:function(e,t){var a=this;this.setState(function(n){return{message:n.message.updateIn(e,function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:_()).push(t)}),messageBuildTimer:a.scheduleBuildMessage(n.messageBuildTimer)}})}},{key:"handleDeleteFromMessage",value:function(e){var t=this;this.setState(function(a){return{message:a.message.deleteIn(e),messageBuildTimer:t.scheduleBuildMessage(a.messageBuildTimer)}})}},{key:"handleSetInMessage",value:function(e,t){var a=this;this.setState(function(n){return{message:n.message.setIn(e,t),messageBuildTimer:a.scheduleBuildMessage(n.messageBuildTimer)}})}},{key:"handleMoveInMessage",value:function(e,t,a){var n=this;this.setState(function(s){return{message:s.message.updateIn(e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_(),n=e.get(t);return e.delete(t).insert(a,n)}),messageBuildTimer:n.scheduleBuildMessage(s.messageBuildTimer)}})}},{key:"componentDidMount",value:function(){var e=d.loadProtosFromStorage(),t=e.map(G);console.log("storedProtos",t),this.setState({rawStoredProtos:e,storedProtos:t})}},{key:"componentDidUpdate",value:function(e,t){t.rawStoredProtos!==this.state.rawStoredProtos&&d.saveProtosToStorage(this.state.rawStoredProtos)}},{key:"scheduleBuildMessage",value:function(e){var t=this;return clearTimeout(e),setTimeout(function(){return t.setState({builtMessage:L.convert(t.state.outputFormat,t.state.messageToBuild,t.state.message),messageBuildTimer:null})},500)}},{key:"fullMessageDescriptorName",value:function(e){if(!e)return"";for(var t=e.name;e.parent&&e.parent.name;)t=e.parent.name+"."+t,e=e.parent;return t=e.filename+":"+t}},{key:"render",value:function(){var e={onAddProto:this.handleAddProto.bind(this),onRemoveProto:this.handleRemoveProto.bind(this),onSelectMessageToBuild:this.handleSelectMessageToBuild.bind(this)},t={onAdd:this.handleAddToMessage.bind(this),onDelete:this.handleDeleteFromMessage.bind(this),onSet:this.handleSetInMessage.bind(this),onMove:this.handleMoveInMessage.bind(this),onSetOutputFormat:this.handleSetOutputFormat.bind(this),onBuild:this.handleBuildMessage.bind(this)};return s.a.createElement("div",{className:"protool"},s.a.createElement("div",{className:"message-builder"},s.a.createElement(w,{key:this.fullMessageDescriptorName(this.state.messageToBuild),messageToBuild:this.state.messageToBuild,message:this.state.message,builtMessage:this.state.builtMessage,buildMessageUpToDate:null===this.state.messageBuildTimer,callbacks:t})),s.a.createElement("div",{className:"proto-library"},s.a.createElement(R,{protoFiles:this.state.storedProtos,callbacks:e})))}}]),t}(s.a.Component);a(71);o.a.render(s.a.createElement(W,null),document.getElementById("root"))}},[[39,2,1]]]);
//# sourceMappingURL=main.6892c971.chunk.js.map